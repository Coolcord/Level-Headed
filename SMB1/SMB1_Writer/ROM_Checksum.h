#ifndef ROM_CHECKSUM_H
#define ROM_CHECKSUM_H

#include "ROM_Type.h"
#include "Unfixed_ROM_Type.h"
#include <QString>
#include <QFile>
#include <QMap>
#include <QByteArray>

class ROM_Checksum {
public:
    ROM_Checksum();
    ~ROM_Checksum();
    QString Get_ROM_Checksum(QFile *file);
    Unfixed_ROM_Type::Unfixed_ROM_Type Get_Unfixed_ROM_Type_From_Checksum(const QString &romChecksum);
    ROM_Type::ROM_Type Get_ROM_Type_From_Checksum(const QString &romChecksum);
    QString Get_ROM_Filename_From_Checksum(const QString &romChecksum);
    ROM_Type::ROM_Type Get_ROM_Type_From_Unfixed_ROM_Type(Unfixed_ROM_Type::Unfixed_ROM_Type unfixedROMType);
    bool Apply_Fixes_To_Match_Checksum(QByteArray &buffer, Unfixed_ROM_Type::Unfixed_ROM_Type unfixedROMType);

private:
    bool Check_ROM_Header(QFile *file);
    bool Check_NES_ROM_Header(QByteArray *buffer);
    bool Check_FDS_ROM_Header(QByteArray *buffer);
    bool Check_No_ROM_Header(QByteArray *buffer);
    bool Check_FDS_No_ROM_Header(QByteArray *buffer);
    bool Check_Tetris_No_ROM_Header(QByteArray *buffer);
    bool Check_Track_No_ROM_Header(QByteArray *buffer);
    bool Check_Trained_No_ROM_Header(QByteArray *buffer);
    void Add_Standard_Header(QByteArray &buffer);
    void Add_Famicom_Header(QByteArray &buffer);
    void Convert_PRG1_To_PRG0(QByteArray &buffer);
    void Convert_DUCK_To_PRG0(QByteArray &buffer);
    void Convert_PC10_To_PRG0(QByteArray &buffer);
    void Convert_P1_To_PRG0(QByteArray &buffer);
    void Convert_TRACK_To_PRG0(QByteArray &buffer);
    void Convert_Trained_To_PRG0(QByteArray &buffer);
    void Convert_25th_Anniversary_To_Normal(QByteArray &buffer);
    void Convert_DUCKE_To_Europe(QByteArray &buffer);
    void Convert_TETRIS_To_Europe(QByteArray &buffer);

    void Write_Bytes_To_Buffer(QByteArray &buffer, int offset, const QByteArray &bytes);

    QMap<QString, Unfixed_ROM_Type::Unfixed_ROM_Type> *checksumMap;
    QMap<QString, QString> *fileNameMap;

    //SHA512
    const QString CHECKSUM_USA0 =               "C2EB66533F2BFEC61F15793884777B1C711AEBD74533CD33BD5774112A0381234583B9AA05588225282FD3071A42A7A4DA27BDE485D21FC0B45B2B2CA2D5461F";
    const QString CHECKSUM_USA0_HEADERLESS =    "28E2B5A96F698F78CE34AE8328B0D264131B9417EAF855938D061C97E6ED8C37642860607E2BCF4EBDA3A838E0C2588E20A134D6A4FAF054EB09F1894E6669C3";
    const QString CHECKSUM_USA1 =               "C254479DF875E6F88F015563271624641433B15DE8242DE99EB883A745D09136C81663CA86613F02188E191B9C86F032D7C2080D4AA470B1CD9DB3695F811914";
    const QString CHECKSUM_USA1_HEADERLESS =    "4D5D45B3E796230A6B3DDCB6BE0093D9190C9A6A4285B423F863214435023A7B5FD24B65FF0B41562AB1C721288599F520461A1664D728E1B82AB60A070F4C8A";
    const QString CHECKSUM_DUCK =               "C900D4B65C956D9BD1FC5459683061017745E23F82588F6C2A152ED4AD4F83025033FB9BE32734D608CC55A4F7A82CCB716BB9CC95EA0542E5F656C69D3E298C";
    const QString CHECKSUM_DUCK_HEADERLESS =    "229F97983105E0DEF92F50449403B561C171E2CCA14251497DDBEF3A8BC1E22CC774401E60887D328F5821E1262AB5A5E534ECE3935CA71719CE41C6FF544B0C";
    const QString CHECKSUM_PC10 =               "3AFE70A07ED50CB7334AC6955739FE0497E067D431A6374D2248A9E24BFDF1C9106D8FC76C7C4DEF4D3EB06FAE6657BA7AC5318F1F9936EB6848681B82DF3361";
    const QString CHECKSUM_PC10_HEADERLESS =    "D1A7F7EFCA98A915D1C091120603BD1741860A51D743785DA51B2B3E160DB25A539F492FE28679B0385338A8CD93E0495420DC88186A723F46FEBD3A8E6E7598";
    const QString CHECKSUM_P1 =                 "50E052FC0D1A4E5B435EBD8B92C0FD6EC98AB3F459576AFAF89649A0142562E34941089B52509405517E8E4670AF79691A66B1FA6B4EC99F7134E6068190678F";
    const QString CHECKSUM_P1_HEADERLESS =      "952E0883ACF91D0483C219A3C4A73739EB72751986CF13A1A660D47F3C82E3C968F3EF53F3082F29271413FC759D514B92559744A6F9DC93FB0618266AA235A6";
    const QString CHECKSUM_TR1 =                "F1F65DBD33C85F2ECD79AF025DAE69CDF80D084A6B613F63615CA070EF01F46EC0E9D383B9A456644380643EA5F968F620858F90A12047B9E0D823C05285F94F";
    const QString CHECKSUM_TR1_HEADERLESS =     "0E9EA4CB3448F4A93C7CF98B37B330DACF6EA23F335BFEA8B6D771B31B2576BDF6B474CB07A6AF7EE7ABF1E1EDFAF27ECF742D488D22E7D6075D41528028E563";
    const QString CHECKSUM_TR2 =                "1431B4B76BCED2F2656216F4AE795E421E9ABFAC0DB094D822B51C8748EE835D3485E635BDB22878309FA7FB4D931CA45AA2BB08E0F9ED6F75009972FB96022A";
    const QString CHECKSUM_TR2_HEADERLESS =     "2A227992A3FB6364FD637BA6A4FB8C16CFEEEF0EC14FBBC5FB2094F99D47C03DAFC2FF5713F61B8BFCDEA2613A684062E2A6E1FEF9AAF528E641DDC2432BA155";
    const QString CHECKSUM_J25 =                "9A6BBD634FB67FBB299863BA47D17EF0BA574B9A7A321817971C8E10B10D88328023C4ED47C3CC79F506F6210566CB49AF7015212E0BC6B7E0FA67282B2963A5";
    const QString CHECKSUM_J25_HEADERLESS =     "140CF606D2E1D97E3D3A1EBA7370123966F5DE804F5F69E07D3FCC3299A96DE08247DFDB8DF7CDC6A2A88EF41669429E1A6B5CB0AE12D40BC30B39483B8976D3";
    const QString CHECKSUM_TRACK =              "7815F5BD6568AE3E2FB428CEA510415FE688971A40AF2E9D354E37AC0D3B98E74F53A8F9BD9A7FBF1785A3B785EF447B5D770F3DE77D21E4B063FC7B5D7DA5EF";
    const QString CHECKSUM_TRACK_HEADERLESS =   "1E77FDFC9E3A72860B4CCEB749AC62B9043E7560C4FC9A3D4ADF0772BED81CF8183928A87F5531037614BAC3F5069AF3172F1D17AACAA399FEDC76B88F0B6015";
    const QString CHECKSUM_TRACK_ALT =          "6EDE50605F65A4EF0930218B4521DD9EC1412B85E1AAF49AB39DE3518574CAB735EA36111AEA0BD443E0C4034A9A7F2AFB682DB46A5884C349900E30B1F00EE9";
    const QString CHECKSUM_TRACK_ALT_HEADERLESS = "2D3DD5C29DF86AFBD6B527655799EEDE31556E6C72D54D88D487C7F910386A2DBC8D0FB53F6A0BF7B63F517C637184AEB3EF13C85206FF127D212E13EA9D2B7D";
    const QString CHECKSUM_EUROPE =             "5683F4ABBF4B2F66403E063594D02183B252BDFB3E6662829EB008C00EAAF0E80671E8745AA067B9A5F46F20E91F2615AE1B67FF1E86D034FE7088677736E5B3";
    const QString CHECKSUM_EUROPE_HEADERLESS =  "D67B83523DCB11E717FA8E1AEBAB6D795ACFA26D6F826426DB8E1A6B3ABB067569CC619F4C7322FCC9C2FC456D6409C6F41E3D928D3F6CBC76A8F271427DB4E6";
    const QString CHECKSUM_DUCKE =              "01F8DAC3E8281C93A758355D0FC9618ED5239B224650BE9241F04CB8231EB3D07D8F6D59CBF3AC24D1D55CB008D7F71F8F76B6630D3DF739265EC4B477D49670";
    const QString CHECKSUM_DUCKE_ALT_HEADER =   "D9D3B91EA137433A2971652A294B697221D16EED8E297A309F3A6176C3E1EFAAC032F8CE5298E001AD593DCE90AF7786B2A8D8CB6FE365A50A638877F3B29BBE";
    const QString CHECKSUM_DUCKE_HEADERLESS =   "5FA2F76D83358720D263E7BC57E9983C51E90A4BC41856A967A4997BB7036361A7C1AF55047239B27E39414B5A77422B788D6934C874E0AD43E3FDFAA30AF6BE";
    const QString CHECKSUM_TETRIS =             "0E198DF9E0D5863F865838EAFF7090596DA548D95CE9CDA8BFBBAF0DC3E6591104140924C1107464CCEE547DA82301E615F1E7B33FB38CE3705B64B5531060D8";
    const QString CHECKSUM_TETRIS_HEADERLESS =  "DC0C6FB3ECC4DD8BA2CC8062E93B898EC75F70F0940CF01436DF9EA642083ADA254ABB3DED0768A85570BA203CD14D1F0C7BDEFBAD06F96CF27A1CEA2A3FAD88";
    const QString CHECKSUM_TETRIS_ALT =         "897BA5A4FF4243C73507F305011B9F2354F27697F28B58E81E730B866A8B44BC3805671A760E6ADFCE78BD1AFE222B1DE65439EB5563BA6DDA537D336CB6E28C";
    const QString CHECKSUM_TETRIS_ALT_HEADERLESS = "10E9E74A092B6BBF87B57A9B21707AF37F4ABD69F6C08BF4C6B66B44F083F2715FEA1D86036FFC9A67794C78504015CA043B1473AAE16DB822AD79AB5EA2BE5A";
    const QString CHECKSUM_E25 =                "95BC4BE071D7AC93820E6B87236FB62BB177DA3CD8815058D28A0C953CA670A00D92E82CE1EA0BB2BA4AA7F7C3FFD20F6FCBDD26E1C3F3D608D5F7E57C06CC4F";
    const QString CHECKSUM_E25_HEADERLESS =     "1EFA3C06D36DBA8FAFBF0E49CC3EFC5D0DEEA1C3B5A5EB023CB66D5334CAA96EF95DC5759DB967B9C00551F45E27D775FCC723F32624F7A747A42CFAD17D8158";
    const QString CHECKSUM_FDS =                "3CB7F3B92CDC6989CEB1DDC04CECA56FAB3CF24BEDB02B655360025027730CF4A1A9D3C793CFD0E9BFD1760C7260D3A4F31F6A5F32E5C725235C57D66498ACCB";
    const QString CHECKSUM_FDS_HEADERLESS =     "1CC96225469B27E3A39FEC3AC4A81A0C3850C0686E825F5DBBB18F82E51FDBCF0E0D27C45E782B2BF0812CAC29916348A046CD978B9183FD645ECCAF84EDCA20";
    const QString CHECKSUM_COOP_CGTI_1 =        "CF536C1E82DA8CE57A8A0BEBDA9050A137F07F3A214AACF837EC7C1E54B921E9998E23EB25124F4759669CDC5274A8B814C0E27349A15062D32A5A2EE31B74E5";
    const QString CHECKSUM_BILL_KILL_2 =        "297FC5BE47C536050202947A19A1AF1551F8C0352224C6ED6DDA2593EC28759F92027C7239BD92B5B74221A16EBB9B756094B46843F449516FD3252427AE1BF3";
};

#endif // ROM_CHECKSUM_H
